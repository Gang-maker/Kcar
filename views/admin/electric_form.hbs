<!DOCTYPE html>
<html lang="en">

<head>
    <title>Add Korean Car | Kcarexport Admin</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Favicon -->
    <link rel="icon" href="/images/auto_favi.ico" type="image/x-icon" />
    
    <!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/f7b393d83e.js" crossorigin="anonymous"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@600;700&display=swap" rel="stylesheet">
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    
    <!-- Custom CSS -->
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #f8f9fa;
            --dark: #343a40;
            --gray: #6c757d;
            --light-gray: #e9ecef;
            --border-radius: 8px;
            --box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f5f7fa;
            color: var(--dark);
            padding: 2rem;
        }
        
        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 2rem;
        }
        
        .page-header {
            border-bottom: 2px solid var(--light-gray);
            padding-bottom: 1rem;
            margin-bottom: 2rem;
        }
        
        .page-title {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            color: var(--primary);
            position: relative;
            display: inline-block;
        }
        
        .page-title::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: -12px;
            width: 50px;
            height: 3px;
            background: var(--accent);
        }
        
        .form-section {
            margin-bottom: 2rem;
        }
        
        .form-section-title {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--light-gray);
        }
        
        .form-group label {
            font-weight: 500;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }
        
        .form-control {
            border-radius: var(--border-radius);
            border: 1px solid var(--light-gray);
            padding: 0.8rem 1rem;
            transition: var(--transition);
        }
        
        .form-control:focus {
            border-color: var(--secondary);
            box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.25);
        }
        
        select.form-control {
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 16px 12px;
        }
        
        /* Image Upload Styling */
        .image-upload-container {
            border: 2px dashed var(--light-gray);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: var(--transition);
        }
        
        .image-upload-container:hover {
            border-color: var(--secondary);
        }
        
        .image-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }
        
        .sortable-image {
            position: relative;
            width: 120px;
            height: 120px;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
        }
        
        .sortable-image:hover {
            transform: translateY(-5px);
        }
        
        .sortable-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .remove-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 25px;
            height: 25px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transition: var(--transition);
        }
        
        .sortable-image:hover .remove-btn {
            opacity: 1;
        }
        
        /* Checkbox Styling */
        .form-check-inline {
            margin-right: 1.5rem;
        }
        
        .form-check-input {
            width: 1.2em;
            height: 1.2em;
            margin-top: 0.15em;
        }
        
        .form-check-label {
            margin-left: 0.5rem;
        }
        
        /* Button Styling */
        .btn-action {
            padding: 0.8rem 2rem;
            border-radius: 50px;
            font-weight: 600;
            letter-spacing: 0.5px;
            transition: var(--transition);
            border: none;
            margin-right: 1rem;
        }
        
        .btn-save {
            background: var(--accent);
            color: white;
        }
        
        .btn-save:hover {
            background: #c0392b;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.3);
        }
        
        .btn-back {
            background: var(--gray);
            color: white;
        }
        
        .btn-back:hover {
            background: #5a6268;
            color: white;
            transform: translateY(-2px);
        }
        
        /* Responsive Adjustments */
        @media (max-width: 768px) {
            body {
                padding: 1rem;
            }
            
            .admin-container {
                padding: 1.5rem;
            }
            
            .form-row > [class*="col-"] {
                margin-bottom: 1rem;
            }
            
            .btn-action {
                width: 100%;
                margin-bottom: 1rem;
            }
        }
    </style>
</head>

<body>
    <div class="admin-container">
        <div class="page-header">
            <h1 class="page-title">Add Korean Car</h1>
        </div>
        
        <form action="addelectric" method="POST" enctype="multipart/form-data" autocomplete="off">
            <!-- Image Upload Section -->
            <div class="form-section">
                <h4 class="form-section-title">
                    <i class="fas fa-images mr-2"></i>Vehicle Images
                </h4>
                <div class="image-upload-container">
                    <div class="form-group">
                        <label>Upload Images (Multiple)</label>
                        <input type="file" class="form-control-file" name="imageupld" id="imageupld" accept="image/*" multiple>
                        <small class="form-text text-muted">Upload high-quality images of the vehicle (max 10 images)</small>
                    </div>
                    <div id="image-preview" class="image-preview"></div>
                </div>
            </div>
            
            <!-- Basic Information Section -->
            <div class="form-section">
                <h4 class="form-section-title">
                    <i class="fas fa-car mr-2"></i>Basic Information
                </h4>
                <div class="form-row">
                    <!-- Manufacturer -->
                    <div class="form-group col-md-4">
                        <label>Manufacturer</label>
                        <select class="form-control" name="manufacturer" id="manufacturer">
                            {{#each dropdownOptions.manufacturers}}
                                <option value="{{this}}">{{this}}</option>
                            {{/each}}
                        </select>
                    </div>
                    
                    <!-- Model -->
                    <div class="form-group col-md-4">
                        <label>Model</label>
                        <select class="form-control" name="model" id="model"></select>
                    </div>
                    
                    <!-- Year -->
                    <div class="form-group col-md-2">
                        <label>Year</label>
                        <select class="form-control" name="year">
                            {{#each dropdownOptions.years}}
                                <option value="{{this}}">{{this}}</option>
                            {{/each}}
                        </select>
                    </div>
                    
                    <!-- Price -->
                    <div class="form-group col-md-2">
                        <label>Price ($)</label>
                        <input type="number" class="form-control" name="price" placeholder="0" required>
                    </div>
                </div>
            </div>
            
            <!-- Technical Details Section -->
            <div class="form-section">
                <h4 class="form-section-title">
                    <i class="fas fa-cogs mr-2"></i>Technical Details
                </h4>
                <div class="form-row">
                    <!-- Mileage -->
                    <div class="form-group col-md-3">
                        <label>Mileage (km)</label>
                        <input type="number" class="form-control" name="mileage" placeholder="0">
                    </div>
                    
                    <!-- Fuel Type -->
                    <div class="form-group col-md-3">
                        <label>Fuel Type</label>
                        <select class="form-control" name="fuelType">
                            {{#each dropdownOptions.fuelTypes}}
                                <option value="{{this}}">{{this}}</option>
                            {{/each}}
                        </select>
                    </div>
                    
                    <!-- Transmission -->
                    <div class="form-group col-md-3">
                        <label>Transmission</label>
                        <select class="form-control" name="transmission">
                            {{#each dropdownOptions.transmissions}}
                                <option value="{{this}}">{{this}}</option>
                            {{/each}}
                        </select>
                    </div>
                    
                    <!-- Status -->
                    <div class="form-group col-md-3">
                        <label>Status</label>
                        <select class="form-control" name="carStatus">
                            {{#each dropdownOptions.carStatus}}
                                <option value="{{this}}">{{this}}</option>
                            {{/each}}
                        </select>
                    </div>
                </div>
            </div>
            
            <!-- Additional Information Section -->
            <div class="form-section">
                <h4 class="form-section-title">
                    <i class="fas fa-info-circle mr-2"></i>Additional Information
                </h4>
                <div class="form-row">
                    <!-- Category -->
                    <div class="form-group col-md-3">
                        <label>Category</label>
                        <select class="form-control" name="category">
                            {{#each dropdownOptions.categories}}
                                <option value="{{this}}">{{this}}</option>
                            {{/each}}
                        </select>
                    </div>
                    
                    <!-- Color -->
                    <div class="form-group col-md-3">
                        <label>Color</label>
                        <select class="form-control" name="color">
                            {{#each dropdownOptions.colors}}
                                <option value="{{this}}">{{this}}</option>
                            {{/each}}
                        </select>
                    </div>
                </div>
                
                <!-- Options -->
                <div class="form-group">
                    <label>Options & Features</label>
                    <div class="options-container">
                        {{#each dropdownOptions.options}}
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" name="options" value="{{this}}" id="option-{{@index}}">
                                <label class="form-check-label" for="option-{{@index}}">{{this}}</label>
                            </div>
                        {{/each}}
                    </div>
                </div>
            </div>
            
            <!-- Form Actions -->
            <div class="form-group text-right">
                <a class="btn btn-action btn-back" href="electric">
                    <i class="fas fa-arrow-left mr-2"></i>Back
                </a>
                <button type="submit" class="btn btn-action btn-save">
                    <i class="fas fa-save mr-2"></i>Save Vehicle
                </button>
            </div>
        </form>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"></script>
    
    <script>
        // Image Upload Preview Functionality
        let filesArr = [];
        const fileInput = document.getElementById('imageupld');
        const preview = document.getElementById('image-preview');
        
        // Initialize SortableJS for image reordering
        new Sortable(preview, {
            animation: 150,
            onEnd: function() {
                updateInputFiles();
            }
        });
        
        fileInput.addEventListener('change', function(event) {
            filesArr = Array.from(event.target.files).slice(0, 10); // Limit to 10 files
            renderPreview();
        });
        
        function renderPreview() {
            preview.innerHTML = '';
            filesArr.forEach((file, idx) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const div = document.createElement('div');
                    div.className = 'sortable-image';
                    
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    
                    const removeBtn = document.createElement('button');
                    removeBtn.className = 'remove-btn';
                    removeBtn.innerHTML = '&times;';
                    removeBtn.onclick = function(e) {
                        e.stopPropagation();
                        filesArr.splice(idx, 1);
                        updateInputFiles();
                        renderPreview();
                    };
                    
                    div.appendChild(img);
                    div.appendChild(removeBtn);
                    preview.appendChild(div);
                };
                reader.readAsDataURL(file);
            });
            updateInputFiles();
        }
        
        function updateInputFiles() {
            const dt = new DataTransfer();
            filesArr.forEach(f => dt.items.add(f));
            fileInput.files = dt.files;
        }
        
        // Dynamic Model Dropdown
        const modelsByManufacturer = {{{json dropdownOptions.models}}};
        
        document.getElementById('manufacturer').addEventListener('change', function() {
            const manufacturer = this.value;
            const modelSelect = document.getElementById('model');
            modelSelect.innerHTML = '';
            
            if (modelsByManufacturer[manufacturer]) {
                modelsByManufacturer[manufacturer].forEach(function(model) {
                    const opt = document.createElement('option');
                    opt.value = model;
                    opt.textContent = model;
                    modelSelect.appendChild(opt);
                });
            }
        });
        
        // Trigger change on page load to populate initial models
        document.getElementById('manufacturer').dispatchEvent(new Event('change'));
    </script>
</body>
</html>